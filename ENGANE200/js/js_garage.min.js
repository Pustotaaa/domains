function carbaseQuickApplicabilityBlockInit(){var a=$(".carbaseAutoChoise #years");a.html('<option value="">'+carbaseApplBlockCarYear+"</option>"),$(".carbaseAutoChoise #manufacturers").html('<option value="">'+carbaseApplBlockCarManufacturer+"</option>"),$(".carbaseAutoChoise #models").html('<option value="">'+carbaseApplBlockCarModel+"</option>"),$(".carbaseAutoChoise #modifications").html('<option value="">'+carbaseApplBlockCarModification+"</option>"),$.ajax({url:"//admin.nodacdn.net/ajax/modules/car.choice/carbase.applicability.json.php",dataType:"jsonp",type:"get",success:function(e){e&&(e.years&&(a.html('<option value="" disabled="disabled" selected="selected">'+carbaseApplBlockCarYear+"</option>"),$.each(e.years,(function(e,i){if(window.isShopMitsubishiMotors&&i<2e3)return!0;a.append('<option value="'+i+'">'+i+"</option>")})),a.removeAttr("disabled")),carbaseQuickApplicabilityHandlersInit())}})}function carbaseQuickApplicabilityHandlersInit(){const a=$(".carbaseApplicabilitySelect");a.off(),a.change((function(){const a=$(".carbaseAutoChoise #years").val(),e=$(".carbaseAutoChoise #manufacturers"),i=e.val(),t=$(".carbaseAutoChoise #models"),o=t.val(),l=$(".carbaseAutoChoise #modifications");let r={};"modifications"!=$(this).attr("id")&&("models"==$(this).attr("id")?(l.attr("disabled","disabled"),l.val(""),$(".carbaseAutoChoiseImage").html(""),r={isPopular:1,years:a,manufacturers:i,models:o,resellerId}):"manufacturers"==$(this).attr("id")?(t.attr("disabled","disabled"),t.val(""),l.attr("disabled","disabled"),l.val(""),$(".carbaseAutoChoiseImage").html(""),r={isPopular:1,years:a,manufacturers:i,resellerId}):"years"==$(this).attr("id")&&(e.attr("disabled","disabled"),e.val(""),t.attr("disabled","disabled"),t.val(""),l.attr("disabled","disabled"),l.val(""),$(".carbaseAutoChoiseImage").html(""),a&&(r={isPopular:1,years:a,resellerId})),r&&(window.isShopMitsubishiMotors&&(r=$.extend(r,{manufacturers:"77"})),window.OriginalSiteLocale&&(r.locale=window.OriginalSiteLocale),$.ajax({url:"//admin.nodacdn.net/ajax/modules/car.choice/carbase.applicability.json.php",dataType:"jsonp",data:r,type:"get",success:function(a){a&&(a.manufacturers&&(e.html('<option value="" disabled="disabled" selected="selected">'+carbaseApplBlockCarManufacturer+"</option>"),$.each(a.manufacturers,(function(a,i){e.append('<option value="'+i.id+'">'+i.name.toUpperCase()+"</option>")})),e.removeAttr("disabled")),a.models&&(t.html('<option value="" disabled="disabled" selected="selected">'+carbaseApplBlockCarModel+"</option>"),$.each(a.models,(function(a,e){t.append('<option value="'+e.id+'" imageUrl="'+e.imageUrl+'">'+e.selectorValue+"</option>")})),t.removeAttr("disabled"),$("select[name='models']").change((function(){var a=$("select[name='models'] option:selected").attr("imageUrl");$(".carbaseAutoChoiseImage").html('<img src="'+a+'" id="carbaseModificationImage" />'),$("#carbaseModificationImage").css({"max-width":"130px"})}))),a.modifications&&(l.html('<option value="" disabled="disabled" selected="selected">'+carbaseApplBlockCarModification+"</option>"),$.each(a.modifications,(function(a,e){l.append('<option value="'+e.id+'" imageUrl="'+e.imageUrl+'">'+e.selectorValue+"</option>")})),l.removeAttr("disabled"),$("select[name='modifications']").change((function(){var a=$("select[name='modifications'] option:selected").attr("imageUrl");$(".carbaseAutoChoiseImage").html('<img src="'+a+'" id="carbaseModificationImage" />'),$("#carbaseModificationImage").css({"max-width":"130px"});var e=$("#goToCarbaseBtn");e.length&&(e.removeAttr("disabled"),e.click((function(){return window.location=SiteLocale+"/carbase?ctModificationId="+$("select[name='modifications']").val(),!1})))}))))}})))}))}function carbaseFullApplicabilityBlockInit(){var a=$("#years");a.html('<option value="">'+carbaseApplBlockCarYear+"</option>"),a.attr("disabled","disabled");var e=$("#manufacturers");e.html('<option value="">'+carbaseApplBlockCarManufacturer+"</option>"),e.attr("disabled","disabled"),e.val("");var i=$("#models");i.html('<option value="">'+carbaseApplBlockCarModel+"</option>"),i.attr("disabled","disabled"),i.val("");var t=$("#modifications");t.html('<option value="">'+carbaseApplBlockCarModification+"</option>"),t.attr("disabled","disabled"),t.val(""),$("#garageName").val(""),$("#garageVin").val(""),$("#garageMileage").val(""),$("#garageDescription").val(""),changeSearchStatus("searching"),$.ajax({url:"//admin.nodacdn.net/ajax/modules/car.choice/carbase.applicability.json.php",dataType:"jsonp",type:"get",success:function(o){o&&(changeSearchStatus("stopsearching"),o.years&&(a.html('<option value="" disabled="disabled" selected="selected">'+carbaseApplBlockCarYear+"</option>"),$.each(o.years,(function(e,i){if(window.isShopMitsubishiMotors&&i<2e3)return!0;a.append('<option value="'+i+'">'+i+"</option>")})),a.removeAttr("disabled"),e.attr("disabled","disabled"),e.val(""),i.attr("disabled","disabled"),i.val(""),t.attr("disabled","disabled"),t.val("")),carbaseFullApplicabilityHandlersInit(),window.defaultAddGarageForm=$("#carbaseApplicabilityBlock").serialize())}}),checkGarageSubmit()}function carbaseFullApplicabilityHandlersInit(){var a=$(".carbaseApplicabilitySelect");a.off(),a.change((function(){var a=$("#years").val(),e=$("#manufacturers"),i=$manufacturer.val(),t=$("#models"),o=t.val(),l={},r=$(this),s=$("#modifications");"modifications"!=r.attr("id")&&("models"==r.attr("id")?(s.attr("disabled","disabled"),s.val(""),a&&i&&o&&(l={years:a,manufacturers:i,models:o})):"manufacturers"==r.attr("id")?(t.attr("disabled","disabled"),t.val(""),s.attr("disabled","disabled"),s.val(""),a&&i&&(l={years:a,manufacturers:i})):"years"==r.attr("id")&&(e.attr("disabled","disabled"),e.val(""),t.attr("disabled","disabled"),t.val(""),s.attr("disabled","disabled"),s.val(""),a&&(l={years:a})),l&&(window.isShopMitsubishiMotors&&(l=$.extend(l,{manufacturers:"77"})),changeSearchStatus("searching"),$.ajax({url:"//admin.nodacdn.net/ajax/modules/car.choice/carbase.applicability.json.php",dataType:"jsonp",data:l,type:"get",success:function(a){a&&(changeSearchStatus("stopsearching"),window.isShopMitsubishiMotors&&(e.html('<option value="77" selected="selected">MITSUBISHI</option>'),e.removeAttr("disabled")),a.manufacturers&&(e.html('<option value="" disabled="disabled" selected="selected">'+carbaseApplBlockCarManufacturer+"</option>"),$.each(a.manufacturers,(function(a,i){e.append('<option value="'+i.id+'">'+i.name.toUpperCase()+"</option>")})),e.removeAttr("disabled")),a.models&&(t.html('<option value="" disabled="disabled" selected="selected">'+carbaseApplBlockCarModel+"</option>"),$.each(a.models,(function(a,e){t.append('<option value="'+e.id+'">'+e.name+"</option>")})),t.removeAttr("disabled")),a.modifications&&(s.html('<option value="" disabled="disabled" selected="selected">'+carbaseApplBlockCarModification+"</option>"),$.each(a.modifications,(function(a,e){s.append('<option value="'+e.id+'">'+e.selectorValue+"</option>")})),s.removeAttr("disabled"),$("select[name='modifications']").change((function(){var a=$("option:selected",e).text()+" "+$("option:selected",t).text()+" "+$("option:selected",s).text();$("#modificationFullNameDiv").html("<span>"+a+"</span>"),$("#garageName").removeAttr("disabled"),$("#garageVin").removeAttr("disabled"),$("#garageMileage").removeAttr("disabled"),$("#garageDescription").removeAttr("disabled")})))),checkGarageSubmit()}})),checkGarageSubmit())}))}function checkGarageSubmit(a,e){var i=(e=e||$("body")).find("#garageSubmit");if(i.length||(i=e.find("#goToCarbaseBtn")),i.length||(i=e.parent().find(".garageCarDialogSaveBtn")),!i.length&&!$(".addCustomerDialogWindow"))return!1;var t=e.find("#garageName"),o=e.find("#garageVin"),l=e.find("#garageFrame"),r=e.find("#choiceManufacturers"),s=e.find("#garageMileage");r.length||(r=e.find("#manufacturers"));var d=e.find('input:radio[name="vinOrFrame"]:checked');d.length||(d=e.find('input:radio[name="selectVinOrFrame"]:checked'));var c=!1;return void 0!==t.val()&&t.val().length>0||"vin"===d.val()&&isVinCorrect(o.val())||"frame"===d.val()&&isFrameCorrect(l.val())?c=!0:(e.find(".validity-field").hide(),"vin"===d.val()?(o.css("border-color","#797979"),o.next(".validity-field").show()):(l.css("border-color","#797979"),l.next(".validity-field").show())),void 0!==s.val()&&s.val().length>0&&null==s.val().match(/^\d+$/)&&(s.next(".validity-field").show(),s.css("border-color","#797979"),c=!1),t.css("border-color",""),o.css("border-color",""),l.css("border-color",""),r.css("border-color",""),s.css("border-color",""),c?(i.removeProp("disabled"),$(".validity-field").hide()):(i.prop("disabled","disabled"),t?.val()?.length||t.css("border-color","#797979"),"vin"!==d.val()||isVinCorrect(o.val())||(o.css("border-color","#797979"),o.next(".validity-field").show()),"frame"!==d.val()||isFrameCorrect(l.val())||(l.css("border-color","#797979"),l.next(".validity-field").show()),r.val()||r.css("border-color","#797979")),void 0===e.data("checkGarageSubmit")&&(e.data("checkGarageSubmit",!0),e.find('#garageName,#garageVin,#garageFrame,#manufacturerId,#choiceManufacturers,#garageMileage,input:radio[name="vinOrFrame"]').on("keyup change",(function(){checkGarageSubmit(null,e)}))),c}$(document).ready((function(){$("#carbaseApplicability").fancybox({autoDimensions:!1,transitionIn:"fade",transitionOut:"fade",speedIn:400,speedOut:200,width:240,height:370,titleShow:!1,centerOnScroll:!0,afterShow:function(){carbaseFullApplicabilityBlockInit()},beforeClose:function(){if(window.defaultAddGarageForm&&window.defaultAddGarageForm!==$("#carbaseApplicabilityBlock").serialize())return window.confirm($("#closeConfirmMessage").val())}}),$("div.carbaseAutoChoise").length>0&&carbaseQuickApplicabilityBlockInit()}));